let db, auth, user;
export const initFirebase = (cfg) => { firebase.initializeApp(cfg); auth = firebase.auth(); db = firebase.database(); };
export const getAuth = () => auth;
export const getDb = () => db;
export const getUser = () => user;
export const signInAnonymously = () => auth.signInAnonymously().then(u => (user = u.user));
export const loadUserProfile = (uid) => db.ref('users/' + uid).once('value').then(s => s.val());
export const saveUserProfile = (uid, p) => db.ref('users/' + uid).set({ profile: p });
export const removeUserProfile = (uid) => db.ref('users/' + uid).remove();
export const listenToRooms = (cb) => db.ref('rooms').limitToLast(10).on('value', s => cb(s.val()));
export const listenToRoomPlayers = (rid, cb) => db.ref(`rooms/${rid}/players`).on('value', s => cb(s.numChildren()));
export const listenToRoomScene = (rid, cb) => db.ref(`rooms/${rid}/current_scene`).on('value', s => cb(s.val()));
export const listenToRoomStatus = (rid, cb) => db.ref(`rooms/${rid}/status`).on('value', s => cb(s.val()));
